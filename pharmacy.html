<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Portale Farmacia - Clinical Wellness</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-slate-100">
    <div id="pharmacy-root"></div>
    
    <script type="text/babel" data-presets="react,typescript">
// --- ICONS ---
const ClipboardListIcon = (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <rect x="8" y="2" width="8" height="4" rx="1" ry="1" />
        <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" />
        <path d="M12 11h4" />
        <path d="M12 16h4" />
        <path d="M8 11h.01" />
        <path d="M8 16h.01" />
    </svg>
);
const CalendarClockIcon = (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5"/><path d="M16 2v4"/><path d="M8 2v4"/><path d="M3 10h18"/><path d="M18 22a4 4 0 1 0 0-8 4 4 0 0 0 0 8Z"/><path d="M18 16.5V18l.5.5"/></svg>
);
const LockIcon = (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
        <path d="M7 11V7a5 5 0 0 1 10 0v4" />
    </svg>
);
const CheckCircleIcon = (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
);
const XCircleIcon = (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>
);
const EyeIcon = (props) => (
    <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z" />
        <circle cx="12" cy="12" r="3" />
    </svg>
);

// --- COMPONENTS ---

const PharmacyLoginScreen = ({ onLogin }) => {
    const [username, setUsername] = React.useState('');
    const [password, setPassword] = React.useState('');
    const [error, setError] = React.useState('');

    const handleSubmit = (e) => {
        e.preventDefault();
        // In un'app reale, qui ci sarebbe una chiamata al server per autenticare
        if (username === 'farmacia' && password === 'password123') {
            onLogin({ name: 'Farmacia Dr. Bianchi' });
        } else {
            setError('Credenziali non valide. Riprova.');
        }
    };

    return (
        <div className="flex items-center justify-center min-h-screen bg-slate-800">
            <div className="w-full max-w-sm">
                <div className="text-center mb-8">
                    <h1 className="text-4xl font-bold text-blue-300">Portale Farmacia</h1>
                    <p className="text-lg text-slate-300">Accesso sicuro</p>
                </div>
                <form onSubmit={handleSubmit} className="bg-white p-8 rounded-2xl shadow-2xl">
                    <div className="flex justify-center mb-6">
                        <LockIcon className="w-12 h-12 text-blue-600"/>
                    </div>
                    {error && <p className="bg-red-100 text-red-700 p-3 rounded-md mb-4 text-center text-sm">{error}</p>}
                    
                    <div className="text-center bg-blue-50 border border-blue-200 p-3 rounded-md mb-4 text-sm text-blue-800">
                        <p className="font-semibold">Credenziali di Prova:</p>
                        <p>Utente: <strong>farmacia</strong></p>
                        <p>Password: <strong>password123</strong></p>
                    </div>

                    <div className="mb-4">
                        <label className="block text-gray-700 text-sm font-bold mb-2" htmlFor="username">Utente</label>
                        <input
                            id="username" type="text" value={username} onChange={(e) => setUsername(e.target.value)}
                            className="shadow-inner appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500"
                        />
                    </div>
                    <div className="mb-6">
                        <label className="block text-gray-700 text-sm font-bold mb-2" htmlFor="password">Password</label>
                        <input
                            id="password" type="password" value={password} onChange={(e) => setPassword(e.target.value)}
                            className="shadow-inner appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500"
                        />
                    </div>
                    <button type="submit" className="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg shadow-lg hover:bg-blue-700 focus:outline-none focus:shadow-outline transition-all duration-300">
                        Accedi
                    </button>
                </form>
            </div>
        </div>
    );
};

const BookingManagementScreen = () => {
    const [bookings, setBookings] = React.useState([]);

    React.useEffect(() => {
        // Legge i dati condivisi dal localStorage
        const allBookings = JSON.parse(localStorage.getItem('spaBookings') || '[]');
        setBookings(allBookings);
    }, []);

    const updateStatus = (id, newStatus) => {
        // Simula una chiamata API aggiornando il localStorage
        const updatedBookings = bookings.map(b => b.id === id ? { ...b, status: newStatus } : b);
        setBookings(updatedBookings);
        localStorage.setItem('spaBookings', JSON.stringify(updatedBookings));
    };

    const StatusChip = ({ status }) => {
        const styles = {
            pending: 'bg-yellow-100 text-yellow-800',
            confirmed: 'bg-green-100 text-green-800',
            rejected: 'bg-red-100 text-red-800',
        };
        const text = {
            pending: 'In attesa',
            confirmed: 'Confermata',
            rejected: 'Rifiutata',
        };
        return <span className={`text-xs font-bold mr-2 px-2.5 py-1 rounded-full ${styles[status]}`}>{text[status]}</span>;
    };

    return (
         <div className="bg-white rounded-lg shadow-xl overflow-hidden">
            <table className="w-full text-sm text-left text-gray-600">
                <thead className="text-xs text-gray-700 uppercase bg-gray-50">
                    <tr>
                        <th scope="col" className="px-6 py-3">Cliente</th>
                        <th scope="col" className="px-6 py-3">Data Richiesta</th>
                        <th scope="col" className="px-6 py-3">Servizi</th>
                        <th scope="col" className="px-6 py-3">Stato</th>
                        <th scope="col" className="px-6 py-3">Azioni</th>
                    </tr>
                </thead>
                <tbody>
                    {bookings.sort((a,b) => new Date(b.dateSubmitted) - new Date(a.dateSubmitted)).map(b => (
                        <tr key={b.id} className="bg-white border-b hover:bg-gray-50">
                            <td className="px-6 py-4 font-medium text-gray-900">
                                {b.userName}<br/>
                                <span className="font-normal text-xs text-gray-500">{b.userEmail}</span>
                            </td>
                            <td className="px-6 py-4">
                                {new Date(b.requestedDate).toLocaleDateString('it-IT')} @ {b.requestedTime}
                            </td>
                            <td className="px-6 py-4 text-xs">
                                {b.services.map(s => s.name).join(', ')}
                            </td>
                            <td className="px-6 py-4">
                                <StatusChip status={b.status} />
                            </td>
                            <td className="px-6 py-4 flex items-center gap-2">
                                {b.status === 'pending' && (
                                    <>
                                        <button onClick={() => updateStatus(b.id, 'confirmed')} className="font-semibold text-green-600 hover:text-green-800 transition-colors p-1 rounded-full hover:bg-green-100" title="Conferma">
                                            <CheckCircleIcon className="w-5 h-5"/>
                                        </button>
                                        <button onClick={() => updateStatus(b.id, 'rejected')} className="font-semibold text-red-600 hover:text-red-800 transition-colors p-1 rounded-full hover:bg-red-100" title="Rifiuta">
                                            <XCircleIcon className="w-5 h-5"/>
                                        </button>
                                    </>
                                )}
                                {b.status !== 'pending' && (
                                     <span className="text-xs text-gray-400">Gestita</span>
                                )}
                            </td>
                        </tr>
                    ))}
                </tbody>
            </table>
             {bookings.length === 0 && <p className="text-center text-gray-500 py-10">Nessuna richiesta di prenotazione ricevuta.</p>}
        </div>
    );
};

const PharmacyDashboard = ({ user, onLogout }) => {
    const [activeTab, setActiveTab] = React.useState('bookings');

    return (
        <div className="min-h-screen bg-slate-100">
             <header className="bg-white shadow-md p-4 flex justify-between items-center">
                <div className="flex items-center gap-3">
                    <h1 className="text-2xl font-bold text-gray-800">Portale Farmacia</h1>
                </div>
                <div className="flex items-center gap-4">
                    <span className="text-gray-600">Benvenuto, <strong>{user.name}</strong></span>
                    <button onClick={onLogout} className="bg-red-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-red-600 transition-colors">
                        Logout
                    </button>
                </div>
            </header>
            <main className="p-8">
                 <div className="mb-6 border-b border-gray-200">
                    <nav className="-mb-px flex space-x-8" aria-label="Tabs">
                        <button onClick={() => setActiveTab('bookings')} className={`group inline-flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-lg ${activeTab === 'bookings' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'}`}>
                           <CalendarClockIcon className="w-6 h-6"/>
                           <span>Gestione Prenotazioni SPA</span>
                        </button>
                         <button onClick={() => setActiveTab('prescriptions')} className={`group inline-flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-lg ${activeTab === 'prescriptions' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'}`}>
                           <ClipboardListIcon className="w-6 h-6"/>
                           <span>Ricette Ricevute (Demo)</span>
                        </button>
                    </nav>
                </div>
                
                {activeTab === 'bookings' && (
                    <>
                        <h2 className="text-3xl font-bold text-gray-700 mb-6">Richieste di Prenotazione SPA</h2>
                        <BookingManagementScreen />
                    </>
                )}
                {activeTab === 'prescriptions' && (
                     <>
                        <h2 className="text-3xl font-bold text-gray-700 mb-6">Ricette Mediche (Demo)</h2>
                        <p className="text-center text-gray-500 py-10 bg-white rounded-lg shadow-xl">Funzionalit√† di gestione ricette non implementata in questa demo.</p>
                     </>
                )}

            </main>
        </div>
    );
};


const PharmacyApp = () => {
    const [user, setUser] = React.useState(null);

    const handleLogin = (loggedInUser) => {
        setUser(loggedInUser);
    };

    const handleLogout = () => {
        setUser(null);
    };

    if (!user) {
        return <PharmacyLoginScreen onLogin={handleLogin} />;
    }

    return <PharmacyDashboard user={user} onLogout={handleLogout} />;
};

// --- RENDER APP ---
const container = document.getElementById('pharmacy-root');
const root = ReactDOM.createRoot(container);
root.render(<PharmacyApp />);

    </script>
</body>
</html>